<?
    $this->headScript()->appendFile("openurl.js");
    if ($this->openUrlEmbed) {
        $classes = "fulltext openUrlEmbed openurl_id:{$this->openUrlId}"
            . ($this->openUrlEmbedAutoLoad ? ' openUrlEmbedAutoLoad' : '');
        $class = ' class="' . $classes . '"';
    } elseif ($this->openUrlWindow) {
        $class = ' class="fulltext openUrlWindow window_settings:' . $this->escapeHtmlAttr($this->openUrlWindow) . '"';
    } else {
        $class = '';
    }
?>
<a href="<?=$this->escapeHtmlAttr($this->openUrlBase . '?' . $this->openUrl)?>"<?=$class?>>
  <? /* put the openUrl here in a span (COinS almost) so we can retrieve it later */ ?>
  <span title="<?=$this->escapeHtmlAttr($this->openUrl)?>" class="openUrl"></span>
  <? if ($this->openUrlGraphic): ?>
    <?
        $style = '';
        if ($this->openUrlGraphicWidth) {
            $style .= 'width:' . $this->escapeHtmlAttr($this->openUrlGraphicWidth) . 'px;';
        }
        if ($this->openUrlGraphicHeight) {
            $style .= 'height:' . $this->escapeHtmlAttr($this->openUrlGraphicHeight) . 'px;';
        }
    ?>
    <img src="<?=$this->escapeHtmlAttr($this->openUrlGraphic)?>" alt="<?=$this->transEsc('Get full text')?>" style="<?=$style?>" />
  <? else: ?>
    <?=$this->transEsc('Get full text')?>
  <? endif; ?>
</a>
<? if ($this->openUrlEmbed): ?>
  <div id="openUrlEmbed<?=$this->openUrlId?>" class="resolver hide"><?=$this->transEsc('Loading')?>...</div>
<? endif; ?>
