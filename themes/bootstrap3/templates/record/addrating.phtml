<?php
    // Set page title.
    $this->headTitle($this->translate('rating_add_or_update'));

    // Set up breadcrumbs:
    $this->layout()->breadcrumbs = $this->searchMemory()->getLastSearchLink($this->transEsc('Search'), '<li>', '</li> ')
      . '<li>' . $this->recordLinker()->getBreadcrumbHtml($this->driver) . '</li> '
      . '<li class="active">' . $this->transEsc('rating_add_or_update') . '</li>';
?>
<h2><?=$this->transEsc('rating_add_or_update') ?></h2>
<form method="post" name="rateRecord" class="form-add-rating">
  <input type="hidden" name="submit" value="1" />
  <input type="hidden" name="id" value="<?=$this->escapeHtmlAttr($this->driver->getUniqueId())?>" />
  <input type="hidden" name="source" value="<?=$this->escapeHtmlAttr($this->driver->getSourceIdentifier())?>" />
  <div class="form-group">
    <label class="control-label" for="add_rating"><?=$this->transEsc('rating_prompt')?>:</label>
    <?=$this->render('Helpers/star-rating.phtml', ['ratingData' => $this->currentRating, 'inputAttrs' => ['data-submit-on-change']]);?>
  </div>
  <div class="form-group">
    <input class="btn btn-primary" type="submit" value="<?=$this->transEscAttr('Save')?>"/>
    <?php if ($this->accountCapabilities()->isRatingRemovalAllowed()): ?>
      <input form="form_remove_rating" class="btn btn-default" type="submit" value="<?=$this->transEscAttr('rating_remove')?>" <?=$this->currentRating['count'] === 0 ? ' disabled' : ''?>/>
    <?php endif; ?>
  </div>
</form>
<?php if ($this->accountCapabilities()->isRatingRemovalAllowed()): ?>
  <form method="post" name="rateRecord" id="form_remove_rating" class="form-remove-rating">
    <input type="hidden" name="submit" value="1" />
    <input type="hidden" name="id" value="<?=$this->escapeHtmlAttr($this->driver->getUniqueId())?>" />
    <input type="hidden" name="source" value="<?=$this->escapeHtmlAttr($this->driver->getSourceIdentifier())?>" />
    <input type="hidden" name="rating" value="" />
  </form>
<?php endif; ?>
